1) FILL_PROMPT v3 (allow_qa 파라미터)

입력 파라미터: allow_qa ("true"/"false")

동작

allow_qa=false(기본): Q&A 신규 추가 금지, 기존 Q&A만 유지/정리

allow_qa=true: 원문 근거가 명확한 경우에만 Q&A 1~3개 추가 허용

출력: plain text만 (## / ### / - bullet 포맷 유지)

→ 사용할 프롬프트: FILL_SECTION_TEXT_PROMPT_V3 (allow_qa 포함)

2) 파이프라인(UI 제어 포함)
처리 순서(품질 최적)

Manualize(JSON) → flatten → section_text 생성/저장

Gate #1 실행 → 섹션별 상태(PASS/NEED_FIX/BLOCK) 저장/표시

NEED_FIX만 Fill 실행(allow_qa 기본 false)

적용 시 저장 → Gate #2 재검증

Publish(RAG 반영)은 PASS 섹션만 허용

UI 상태 규칙

PASS

Fill 버튼: 비활성

힌트: “✅ RAG 반영 가능”

NEED_FIX

Fill 버튼: 활성

힌트: “🔧 Fill 보강 → Gate 재검증”

BLOCK

Fill 버튼: 비활성

힌트: “⛔ 수동 수정 필요”

✅ Gate 결과가 오면 즉시 버튼 상태/힌트 갱신

3) “🔧 NEED_FIX 일괄 보강” 버튼

위치: 에디터 하단

활성 조건: NEED_FIX 섹션이 1개 이상일 때만 활성

동작

NEED_FIX 섹션만 순차 Fill 실행

각 섹션마다 diff 모달 표시

사용자가 “적용/건너뛰기” 선택

적용이면 저장 → Gate 재검증 → UI 갱신 후 다음 섹션

기본값 추천: allow_qa=false (안전/환각 방지)